@use '../variables' as *;
@use '../mixins' as *;

.carousel {
	max-width: 1200px;
	margin: 0 auto;
	padding: 0 calc($gap-medium + 50px);
	position: relative;

	&__container {
		position: relative;
		overflow: hidden;
		border-radius: 8px;
	}

	&__input {
		display: none;
	}

	&__track {
		display: flex;
		transition: transform $transition-slow;
		will-change: transform;
		width: 300%;
	}

	&__slide {
		display: flex;
		flex-direction: row;
		align-items: stretch;
		gap: $gap-large;
		min-width: 33.333%;
		flex-shrink: 0;
		padding: $gap-large;

		@media (max-width: $mobile) {
			padding: $gap-medium;
			gap: $gap-medium;
		}
	}

	&__controls {
		position: absolute;
		top: 0;
		left: 0;
		right: 0;
		bottom: 0;
		pointer-events: none;
		z-index: 10;
	}

	&__btn {
		@include flex-center;

		position: absolute;
		top: 50%;
		transform: translateY(-50%);
		pointer-events: all;
		width: 50px;
		height: 50px;
		background-color: rgba(255, 255, 255, 0.9);
		color: $bg-dark;
		border-radius: 50%;
		font-size: 1.5rem;
		font-weight: bold;
		cursor: pointer;
		transition: all $transition-fast;
		box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
		opacity: 0;
		visibility: hidden;

		&:hover {
			background-color: $accent;
			color: $text-light;
			transform: translateY(-50%) scale(1.1);
		}

		&--1, &--2, &--3 {
			left: 0;
		}

		&--next-1, &--next-2, &--next-3 {
			right: 0;
		}

		@media (max-width: $tablet) {
			width: 40px;
			height: 40px;
			font-size: 1.2rem;
		}
	}

	&__indicators {
		position: absolute;
		bottom: $gap-medium;
		left: 50%;
		transform: translateX(-50%);
		display: flex;
		gap: $gap-small;
		z-index: 10;
	}

	&__indicator {
		width: 12px;
		height: 12px;
		border-radius: 50%;
		background-color: rgba(255, 255, 255, 0.5);
		cursor: pointer;
		transition: background-color $transition-fast;

		&:hover {
			background-color: rgb(255, 255, 255);
		}
	}

	// Mixin pour éviter la répétition
	@mixin carousel-states($prefix: '') {
		$slide1: if($prefix == '', 'slide1', '#{$prefix}-slide1');
		$slide2: if($prefix == '', 'slide2', '#{$prefix}-slide2');
		$slide3: if($prefix == '', 'slide3', '#{$prefix}-slide3');

		// États des slides
		##{$slide1}:checked ~ .carousel__track { transform: translateX(0%); }
		##{$slide2}:checked ~ .carousel__track { transform: translateX(-33.333%); }
		##{$slide3}:checked ~ .carousel__track { transform: translateX(-66.666%); }

		// Boutons
		##{$slide1}:checked ~ .carousel__controls .carousel__btn--next-1 {
			opacity: 1; visibility: visible;
		}
		##{$slide2}:checked ~ .carousel__controls .carousel__btn--1,
		##{$slide2}:checked ~ .carousel__controls .carousel__btn--next-2 {
			opacity: 1; visibility: visible;
		}
		##{$slide3}:checked ~ .carousel__controls .carousel__btn--2,
		##{$slide3}:checked ~ .carousel__controls .carousel__btn--next-3 {
			opacity: 1; visibility: visible;
		}

		// Indicateurs
		##{$slide1}:checked ~ .carousel__indicators .carousel__indicator:nth-child(1),
		##{$slide2}:checked ~ .carousel__indicators .carousel__indicator:nth-child(2),
		##{$slide3}:checked ~ .carousel__indicators .carousel__indicator:nth-child(3) {
			background-color: $accent;
		}
	}

	// Application du mixin pour chaque carousel
	@include carousel-states('carousel1'); // Premier carousel
	@include carousel-states('carousel2'); // Deuxieme carousel
	@include carousel-states('carousel3'); // Troisième carousel
}
